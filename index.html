<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>برنامه هفتگی مطالعه | آکادمی رادیان</title>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <style>
        /* === سبک‌دهی عمومی و فونت - هارمونی آبی کاربنی/زنده === */
        :root {
            --primary-color: #1A237E; /* آبی کاربنی تیره */
            --secondary-color: #2979FF; /* آبی زنده و جذاب (رنگ درخواستی) */
            --accent-color: #448AFF; /* آبی روشن‌تر برای تاکید */
            --background-light: #f4f7f9;
            --card-background: #ffffff;
            --border-radius: 12px;
            --box-shadow-light: 0 4px 10px rgba(0, 0, 0, 0.05);
            --box-shadow-hover: 0 8px 16px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: var(--background-light);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            direction: rtl;
        }

        /* === کانتینر اصلی و ریسپانسیو === */
        .app-container {
            max-width: 1300px;
            margin: 0 auto;
            background: linear-gradient(135deg, #ffffff 0%, #f7faff 100%);
            border-radius: var(--border-radius);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .app-container {
                padding: 15px;
                border-radius: 8px;
            }
            .input-group {
                min-width: 100% !important;
            }
        }
        
        /* === بخش هدر و لوگو === */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }

        .logo-container {
            margin-bottom: 15px;
        }

        .logo {
            max-width: 150px;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .title {
            font-size: 32px;
            font-weight: 800;
            color: var(--primary-color);
            margin-bottom: 5px;
            letter-spacing: 1px;
        }

        .subtitle {
            font-size: 18px;
            color: var(--secondary-color);
            font-weight: 500;
        }
        
        /* === فرم ورودی‌های اولیه === */
        .initial-fields {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #e3f2fd; /* سایه روشن آبی جدید */
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-light);
        }

        .input-group {
            flex: 1 1 30%; 
            min-width: 250px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary-color);
            font-size: 14px;
        }

        .input-group input {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-family: 'Vazirmatn', sans-serif;
            font-size: 16px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .input-group input:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(41, 121, 255, 0.2);
            outline: none;
        }
        
        /* === کانتینر روزها === */
        .days-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        /* === کارت هر روز === */
        .day-card {
            background-color: var(--card-background);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-light);
            padding: 20px;
            transition: transform 0.3s, box-shadow 0.3s;
            display: flex;
            flex-direction: column;
            min-height: 400px;
            border: 1px solid #eee;
        }

        .day-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--box-shadow-hover);
        }

        .day-header {
            font-size: 24px;
            font-weight: 700;
            text-align: center;
            padding: 10px;
            margin: -20px -20px 20px -20px;
            border-top-left-radius: var(--border-radius);
            border-top-right-radius: var(--border-radius);
            color: white;
            letter-spacing: 1px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* رنگ‌بندی روزها با هارمونی آبی */
        .day-card[data-day="شنبه"] .day-header { background-color: #2979FF; } 
        .day-card[data-day="یکشنبه"] .day-header { background-color: #1E88E5; }
        .day-card[data-day="دوشنبه"] .day-header { background-color: #1565C0; }
        .day-card[data-day="سه‌شنبه"] .day-header { background-color: #0D47A1; }
        .day-card[data-day="چهارشنبه"] .day-header { background-color: #3F51B5; }
        .day-card[data-day="پنج‌شنبه"] .day-header { background-color: #303F9F; }
        .day-card[data-day="جمعه"] .day-header { background-color: #1A237E; } /* تیره ترین برای روز استراحت/مرور */

        /* === بلوک زمانی (صبح، ظهر، شب) === */
        .time-period-section {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            border: 1px dashed var(--secondary-color); /* تغییر به آبی */
            background-color: #f7fbff; /* پس زمینه بسیار روشن */
        }
        
        .time-period-header {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .time-period-header .material-icons {
            margin-left: 5px;
            color: var(--secondary-color); /* تغییر به آبی */
            font-size: 20px;
        }
        
        .study-parts {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        /* === پارت مطالعاتی === */
        .study-part {
            background-color: #e3f2fd; /* سایه روشن آبی جدید */
            border-radius: 8px;
            padding: 12px;
            border-right: 5px solid var(--secondary-color); /* تغییر به آبی زنده */
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            position: relative;
        }
        
        .study-part:hover {
            background-color: #bbdefb; /* روشن‌تر هنگام هاور */
        }

        .part-details {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .part-details input {
            flex: 1 1 30%;
            padding: 8px 10px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-family: 'Vazirmatn', sans-serif;
            font-size: 14px;
            min-width: 120px;
        }
        
        .part-details .delete-btn {
            background-color: #D32F2F; /* رنگ ثابت برای دکمه حذف */
            color: white;
            border: none;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-size: 12px;
            flex-basis: 40px;
            flex-grow: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .part-details .delete-btn:hover {
            background-color: #C62828;
        }
        
        /* === دکمه افزودن پارت === */
        .add-part-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Vazirmatn', sans-serif;
            font-size: 14px;
            margin-top: 10px;
            width: 100%;
            transition: background-color 0.3s, transform 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .add-part-btn:hover {
            background-color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .add-part-btn .material-icons {
            font-size: 18px;
            margin-left: 5px;
        }
        
        /* === دکمه دانلود PDF === */
        .pdf-download-container {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }

        .download-btn {
            background-color: var(--secondary-color); /* تغییر به آبی زنده */
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 20px;
            font-weight: 600;
            font-family: 'Vazirmatn', sans-serif; /* **اضافه شدن فونت** */
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 4px 15px rgba(41, 121, 255, 0.4); /* سایه آبی */
            display: inline-flex;
            align-items: center;
        }

        .download-btn:hover {
            background-color: #1E88E5; /* سایه کمی تیره‌تر از آبی زنده */
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(41, 121, 255, 0.6);
        }

        .download-btn .material-icons {
            margin-left: 10px;
            font-size: 24px;
        }

        /* === سبک‌دهی PDF (فقط برای چاپ) === */
        @media print {
            body {
                padding: 0 !important;
                background-color: white !important;
                direction: rtl !important;
            }
            .app-container {
                max-width: none !important;
                box-shadow: none !important;
                border-radius: 0 !important;
                padding: 10mm !important;
                min-height: 297mm; 
                width: 210mm;
                margin: 0 auto;
                background: white !important;
            }
            
            /* پنهان کردن عناصر ناخواسته در چاپ */
            .initial-fields, .pdf-download-container, .time-period-section button, .study-part .delete-btn {
                display: none !important; 
            }
            
            .header {
                border-bottom: 2px solid var(--primary-color) !important; /* خط زیر آبی کاربنی */
                margin-bottom: 15px !important;
            }
            
            /* نمایش اطلاعات اولیه (از فیلدهای مخفی) در PDF - جذاب‌تر */
            .pdf-info {
                display: flex !important;
                justify-content: space-around;
                margin-bottom: 20px;
                font-size: 14px;
                padding: 12px;
                border: 2px solid var(--secondary-color); /* کادر آبی زنده */
                border-radius: 8px;
                background-color: #e3f2fd; /* پس زمینه روشن آبی */
            }
            .pdf-info div {
                font-weight: 500;
                color: #333;
                border-left: 1px solid #c8e6c9;
                padding-left: 15px;
            }
            .pdf-info div:last-child {
                border-left: none;
                padding-left: 0;
            }
            .pdf-info b {
                font-weight: 700;
                color: var(--primary-color); /* نام آیتم به آبی کاربنی */
                margin-left: 5px;
            }
            
            .days-container {
                display: flex !important;
                flex-wrap: wrap !important;
                gap: 10px !important;
                page-break-inside: avoid;
            }
            .day-card {
                width: calc(33.333% - 10px) !important;
                box-shadow: none !important;
                border: 1px solid #ccc !important;
                padding: 10px !important;
                min-height: 250px !important;
                break-inside: avoid;
                transition: none; 
            }
            .day-card:hover {
                transform: none;
                box-shadow: none;
            }
            .day-header {
                font-size: 18px !important;
                margin: -10px -10px 15px -10px !important;
            }
            
            .time-period-section {
                border: none !important;
                padding: 0 !important;
                background-color: transparent !important;
            }
            
            /* پنهان کردن بلوک‌های زمانی خالی در حالت چاپ */
            .time-period-section[data-empty="true"] {
                display: none !important;
            }

            .time-period-header {
                font-size: 16px !important;
                color: var(--primary-color) !important; /* سرتیتر به رنگ کاربنی */
                border-bottom: 1px solid var(--secondary-color); /* خط زیر آبی زنده */
                padding-bottom: 5px;
                margin-bottom: 5px !important;
            }
            .time-period-header .material-icons {
                display: none;
            }
            
            .study-part {
                margin-bottom: 5px;
                padding: 8px !important;
                font-size: 13px !important;
                border-right: 5px solid #2979FF !important; /* آبی زنده برای نوار کناری */
                background-color: #f7fbff !important; /* پس زمینه روشن آبی برای پارت */
            }
            
            /* استایل‌دهی فیلدهای ورودی برای چاپ شدن به عنوان متن ساده */
            .part-details input {
                border: none !important;
                padding: 0 0 2px 0 !important;
                margin: 0 10px 0 0 !important; /* اضافه کردن فاصله مناسب */
                background: transparent !important;
                font-size: 13px !important;
                font-weight: 600;
                display: inline-block !important; 
                width: auto !important;
                color: #333 !important;
            }

            /* **ایجاد برچسب‌های فارسی از طریق data-label** */
            .part-details input::before {
                content: attr(data-label) " "; /* برچسب از data-label + فاصله */
                font-weight: 700;
                color: var(--primary-color);
            }
            
            .part-details {
                display: block !important;
                line-height: 1.4;
            }
            
            .part-details div {
                margin-bottom: 2px;
            }
        }
        
        /* === استایل برای نمایش اطلاعات در PDF (مخفی در حالت عادی) === */
        .pdf-info {
            display: none; 
        }
    </style>
</head>
<body>
    <div class="app-container" id="appContainer">
        
        <div class="header">
            <div class="logo-container">
                <img src="https://www.radianlearn.ir/wp-content/uploads/2023/10/20240324_231900-min.png" alt="لوگوی آکادمی رادیان" class="logo">
            </div>
            <h1 class="title">برنامه ریزی هفتگی مطالعه</h1>
            <p class="subtitle">طراحی شده توسط آکادمی تحصیلی رادیان</p>
        </div>

        <div class="initial-fields">
            <div class="input-group">
                <label for="counselorName">نام مشاور:</label>
                <input type="text" id="counselorName" placeholder="نام مشاور خود را وارد کنید" value="">
            </div>
            <div class="input-group">
                <label for="studentName">نام دانش آموز:</label>
                <input type="text" id="studentName" placeholder="نام دانش آموز را وارد کنید" value="">
            </div>
            <div class="input-group">
                <label for="reportDate">تاریخ گزارش (شمسی):</label>
                <input type="text" id="reportDate" placeholder="تاریخ امروز" dir="ltr">
            </div>
        </div>

        <div class="pdf-info" id="pdfInfo">
            </div>

        <div class="days-container" id="daysContainer">
            </div>

        <div class="pdf-download-container">
            <button class="download-btn" id="downloadPdfBtn">
                <span class="material-icons">download</span>
                دانلود برنامه به صورت PDF
            </button>
        </div>
    </div>

    <script>
        // === توابع کمکی تاریخ (شمسی عددی) ===
        function getPersianDateNumeric() {
            try {
                // دریافت تاریخ شمسی به صورت عددی (مثلاً ۱۴۰۲/۰۷/۰۵)
                return new Intl.DateTimeFormat('fa-IR', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit'
                }).format(new Date());
            } catch (e) {
                console.error("خطا در دریافت تاریخ شمسی:", e);
                return new Date().toLocaleDateString('fa-IR');
            }
        }
        
        // === تولید HTML پارت مطالعاتی ===
        function createStudyPartHTML(book = '', topic = '', tests = '') {
            const id = Date.now() + Math.floor(Math.random() * 1000);
            return `
                <div class="study-part" data-id="${id}">
                    <div class="part-details">
                        <input type="text" value="${book}" placeholder="نام کتاب" data-label="کتاب:"> 
                        <input type="text" value="${topic}" placeholder="مبحث/فصل" data-label="مبحث:"> 
                        <input type="number" value="${tests}" placeholder="تعداد تست" min="0" data-label="تست:"> 
                        <button type="button" class="delete-btn" onclick="removeStudyPart(this)">
                            <span class="material-icons" style="font-size: 18px;">delete</span>
                        </button>
                    </div>
                </div>
            `;
        }
        
        // === تولید HTML بلوک زمانی (صبح/بعد از ظهر/شب) ===
        function createTimePeriodHTML(periodName, icon, periodKey) {
            return `
                <div class="time-period-section" data-period="${periodKey}">
                    <div class="time-period-header">
                        <span class="material-icons">${icon}</span>
                        <span>${periodName}</span>
                    </div>
                    <div class="study-parts">
                        </div>
                    <button type="button" class="add-part-btn" onclick="addStudyPart(this)">
                        <span class="material-icons">add</span>
                        افزودن پارت
                    </button>
                </div>
            `;
        }

        // === تولید HTML کارت روز ===
        function createDayCardHTML(dayName) {
            return `
                <div class="day-card" data-day="${dayName}">
                    <div class="day-header">${dayName}</div>
                    ${createTimePeriodHTML('صبحگاهی', 'wb_sunny', 'morning')}
                    ${createTimePeriodHTML('بعد از ظهر', 'schedule', 'afternoon')}
                    ${createTimePeriodHTML('شبانه', 'nights_stay', 'evening')}
                </div>
            `;
        }
        
        // === مدیریت پارت‌های مطالعاتی ===
        function addStudyPart(buttonElement) {
            const studyPartsContainer = buttonElement.previousElementSibling;
            studyPartsContainer.insertAdjacentHTML('beforeend', createStudyPartHTML());
            // هر بار که پارتی اضافه می‌شود، پرچم خالی بودن بخش زمانی را برمی‌داریم
            const section = buttonElement.closest('.time-period-section');
            if (section) section.removeAttribute('data-empty');
        }

        function removeStudyPart(buttonElement) {
            const studyPart = buttonElement.closest('.study-part');
            const section = studyPart.closest('.time-period-section');
            studyPart.remove();
            
            // چک می‌کنیم اگر بعد از حذف، بخش زمانی خالی شد، پرچم خالی بودن را بگذاریم
            if (section && section.querySelectorAll('.study-part').length === 0) {
                section.setAttribute('data-empty', 'true');
            }
        }

        // === تابع اصلی تولید برنامه هفتگی ===
        function renderWeeklySchedule() {
            const days = ["شنبه", "یکشنبه", "دوشنبه", "سه‌شنبه", "چهارشنبه", "پنج‌شنبه", "جمعه"];
            const daysContainer = document.getElementById('daysContainer');
            daysContainer.innerHTML = ''; 
            
            days.forEach(day => {
                daysContainer.insertAdjacentHTML('beforeend', createDayCardHTML(day));
            });
            
            // تنظیم تاریخ پیش‌فرض شمسی (عددی)
            document.getElementById('reportDate').value = getPersianDateNumeric();
            
            // تنظیم همه بخش‌های زمانی به حالت خالی (پیش‌فرض)
            document.querySelectorAll('.time-period-section').forEach(section => {
                 section.setAttribute('data-empty', 'true');
            });
        }
        
        // === آماده‌سازی برای چاپ (PDF) ===
        function prepareForPrint() {
            // 1. نمایش و پر کردن اطلاعات اولیه برای PDF
            const pdfInfo = document.getElementById('pdfInfo');
            const counselorName = document.getElementById('counselorName').value;
            const studentName = document.getElementById('studentName').value;
            const reportDate = document.getElementById('reportDate').value;

            pdfInfo.innerHTML = `
                <div><b>مشاور:</b> ${counselorName || '---'}</div>
                <div><b>دانش‌آموز:</b> ${studentName || '---'}</div>
                <div><b>تاریخ گزارش:</b> ${reportDate || '---'}</div>
            `;
            
            // 2. اعمال پرچم خالی بودن/نبودن برای پنهان‌سازی بخش‌های خالی در CSS
            document.querySelectorAll('.time-period-section').forEach(section => {
                const partsCount = section.querySelector('.study-parts').children.length;
                if (partsCount === 0) {
                    section.setAttribute('data-empty', 'true');
                } else {
                    section.removeAttribute('data-empty');
                }
            });

            // 3. فراخوانی دستور چاپ
            window.print();
        }


        // === رویدادها ===
        document.addEventListener('DOMContentLoaded', () => {
            renderWeeklySchedule();
            
            document.getElementById('downloadPdfBtn').addEventListener('click', prepareForPrint);
        });

    </script>
</body>
</html>
